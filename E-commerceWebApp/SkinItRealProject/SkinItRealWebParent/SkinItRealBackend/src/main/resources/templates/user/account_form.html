<!DOCTYPE html>
<html xmlns:th="http://www.thymeLeaf.org">
<head th:replace="fragments :: page_head('Your account details')"/>
<body>
<div class="container-fluid">
<div th:replace="navigation :: menu"></div>
<div><h3 style="color:#af5175;margin-left:150px">Your account details</h3></div>
<form th:action="@{/account/update}" method="post" style="max-width: 700px; margin:0 auto"
	th:object="${user}">
<div class="border border-secondary rounded p-3">
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">E-mail</label>
		<div class="col-sm-8">
			<input type="email" class="form-control" th:field="*{email}" readonly="readonly"/>
	
		</div>
	</div>
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">First Name</label>
		<div class="col-sm-8">
			<input type="text" class="form-control" th:field="*{firstName}" />
		</div>
	</div>
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">Last Name</label>
		<div class="col-sm-8">
			<input type="text" class="form-control" th:field="*{lastName}" />
		</div>
	</div>
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">Password</label>
			<div class="col-sm-8">
			<input type="password" th:field="*{password}" class="form-control"
			placeholder="don't type anything if you don't want to change the pass"
			oninput="checkPasswordMatch(document.getElementById('confirmPassword'))"/>
			</div>
	</div> 
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">Confirm Password</label>
		<div class="col-sm-8">
			<input type="password" id="confirmPassword" class="form-control"
			oninput="checkPasswordMatch(this)"/>
			</div>
	</div> 
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">Roles</label>
		<div class="col-sm-8">
			<span><b>[[${user.roles}]]</b></span>
		</div>
	</div> 
	
	<div class="form-group row">
		<label class="col-sm-4 col-form-label">Enabled</label>
		<div class="col-sm-8">
			<input type="checkbox"  th:field="*{enabled}" />
		</div>
	</div>
	

	<div class="text-center">
		<input type="submit" value="Save" class="btn btn-dark m-3"/>
		<input type="button" value="Cancel" class="btn btn-light" id="btnCancel"/>
	</div>
</div>
</form>
<div class="modal fade text-center" id="modalDialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
			   <h4 class="modal-title" id="modalTitle">Warning</h4>
			   <button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>
		<div class="modal-body">
			<span id="modalBody"></span>
		</div>
		<div class="modal-fotter">
			<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
		</div>
		</div>
	</div>
</div>
<div class="text-center">
<p>SkinItReal Control Pane - Copyright &copy; SkinItReal</p>
</div>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$("#btnCancel").on("click",function(){
			window.location="[[@{/users}]]";
		});
	});
	function checkEmailUnique(form){
		url="[[@{/users/check_email}]]";
		userEmail=$("#email").val();
		csrfValue=$("input[name='_csrf']").val();
		params={email:userEmail,_csrf:csrfValue};


		
		$.post(url,params,function(response){
			if(response=="OK"){
				form.submit();
			}else if(response =="Duplicated"){
				showModalDialog("Warning","There is another user having that email");
			}
		});
		return false;
		}
		function showModalDialog(title,message){
			$("#modalTitle").text(title);
			$("#modalBody").text(message);
			$("#modalDialog").modal();
		}
		function checkPasswordMatch(confirmPassword){
			if(confirmPassword.value != $('#password').val()){
			confirmPassword.setCustomValidity("Password do not match!");
			}else{
			confirmPassword.setCustomValidity("");
			}
		}
</script>
</body>

</html>